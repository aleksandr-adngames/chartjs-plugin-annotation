/*!
 * chartjs-plugin-annotation.js
 * http://chartjs.org/
 * Version: 0.5.7
 *
 * Copyright 2016 Evert Timberg
 * Released under the MIT license
 * https://github.com/chartjs/Chart.Annotation.js/blob/master/LICENSE.md
 */
!function(){function e(t,n,a){function i(l,r){if(!n[l]){if(!t[l]){var s="function"==typeof require&&require;if(!r&&s)return s(l,!0);if(o)return o(l,!0);var u=new Error("Cannot find module '"+l+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[l]={exports:{}};t[l][0].call(c.exports,function(e){var n=t[l][1][e];return i(n||e)},c,c.exports,e,t,n,a)}return n[l].exports}for(var o="function"==typeof require&&require,l=0;l<a.length;l++)i(a[l]);return i}return e}()({1:[function(e,t,n){},{}],2:[function(e,t,n){t.exports=function(t){function n(e){o.decorate(e,"afterDataLimits",function(e,t){e&&e(t),o.adjustScaleRange(t)})}function a(e){return function(t,n){var a=t.annotation.options.drawTime;o.elements(t).filter(function(t){return e===(t.options.drawTime||a)}).forEach(function(e){e.transition(n).draw()})}}var i=t.helpers,o=e("./helpers.js")(t),l=e("./events.js")(t),r=t.Annotation.types;return{beforeInit:function(e){var t=e.options,a=e.annotation={elements:{},options:o.initConfig(t.annotation||{}),onDestroy:[],firstRun:!0,supported:!1};e.ensureScalesHaveIDs(),t.scales&&(a.supported=!0,i.each(t.scales.xAxes,n),i.each(t.scales.yAxes,n))},beforeUpdate:function(e){var t=e.annotation;if(t.supported){t.firstRun?t.firstRun=!1:t.options=o.initConfig(e.options.annotation||{});var n=[];t.options.annotations.forEach(function(a){var i=a.id||o.objectId();if(!t.elements[i]&&r[a.type]){var l=r[a.type],s=new l({id:i,options:a,chartInstance:e});s.initialize(),t.elements[i]=s,a.id=i,n.push(i)}else t.elements[i]&&n.push(i)}),Object.keys(t.elements).forEach(function(e){n.indexOf(e)===-1&&(t.elements[e].destroy(),delete t.elements[e])})}},afterScaleUpdate:function(e){o.elements(e).forEach(function(e){e.configure()})},beforeDatasetsDraw:a("beforeDatasetsDraw"),afterDatasetsDraw:a("afterDatasetsDraw"),afterDraw:a("afterDraw"),afterInit:function(e){var t=e.annotation.options.events;if(i.isArray(t)&&t.length>0){var n=e.chart.canvas,a=l.dispatcher.bind(e);l.collapseHoverEvents(t).forEach(function(t){i.addEvent(n,t,a),e.annotation.onDestroy.push(function(){i.removeEvent(n,t,a)})})}},destroy:function(e){for(var t=e.annotation.onDestroy;t.length>0;)t.pop()()}}}},{"./events.js":4,"./helpers.js":5}],3:[function(e,t,n){t.exports=function(e){var t=e.helpers,n=e.Element.extend({initialize:function(){this.hidden=!1,this.hovering=!1,this._model=t.clone(this._model)||{},this.setDataLimits()},destroy:function(){},setDataLimits:function(){},configure:function(){},inRange:function(){},getCenterPoint:function(){},getWidth:function(){},getHeight:function(){},getArea:function(){},draw:function(){}});return n}},{}],4:[function(e,t,n){t.exports=function(t){function n(e){var t=!1,n=e.filter(function(e){switch(e){case"mouseenter":case"mouseover":case"mouseout":case"mouseleave":return t=!0,!1;default:return!0}});return t&&n.indexOf("mousemove")===-1&&n.push("mousemove"),n}function a(e){var t=this.annotation,a=o.elements(this),l=i.getRelativePosition(e,this.chart),r=o.getNearestItems(a,l),s=n(t.options.events),u=t.options.dblClickSpeed,c=[],b=o.getEventHandlerName(e.type),d=(r||{}).options;if("mousemove"===e.type&&(r&&!r.hovering?["mouseenter","mouseover"].forEach(function(t){var n=o.getEventHandlerName(t),a=o.createMouseEvent(t,e);r.hovering=!0,"function"==typeof d[n]&&c.push([d[n],a,r])}):r||a.forEach(function(t){if(t.hovering){t.hovering=!1;var n=t.options;["mouseout","mouseleave"].forEach(function(a){var i=o.getEventHandlerName(a),l=o.createMouseEvent(a,e);"function"==typeof n[i]&&c.push([n[i],l,t])})}})),r&&s.indexOf("dblclick")>-1&&"function"==typeof d.onDblclick){if("click"===e.type&&"function"==typeof d.onClick)return clearTimeout(r.clickTimeout),r.clickTimeout=setTimeout(function(){delete r.clickTimeout,d.onClick.call(r,e)},u),e.stopImmediatePropagation(),void e.preventDefault();"dblclick"===e.type&&r.clickTimeout&&(clearTimeout(r.clickTimeout),delete r.clickTimeout)}r&&"function"==typeof d[b]&&0===c.length&&c.push([d[b],e,r]),c.length>0&&(e.stopImmediatePropagation(),e.preventDefault(),c.forEach(function(e){e[0].call(e[2],e[1])}))}var i=t.helpers,o=e("./helpers.js")(t);return{dispatcher:a,collapseHoverEvents:n}}},{"./helpers.js":5}],5:[function(e,t,n){function a(){}function i(e){var t=e.annotation.elements;return Object.keys(t).map(function(e){return t[e]})}function o(){return Math.random().toString(36).substr(2,6)}function l(e){return null!==e&&"undefined"!=typeof e&&("number"==typeof e?isFinite(e):!!e)}function r(e,t,n){var a="$";e[a+t]||(e[t]?(e[a+t]=e[t].bind(e),e[t]=function(){var i=[e[a+t]].concat(Array.prototype.slice.call(arguments));return n.apply(e,i)}):e[t]=function(){var t=[void 0].concat(Array.prototype.slice.call(arguments));return n.apply(e,t)})}function s(e,t){e.forEach(function(e){(t?e[t]:e)()})}function u(e){return"on"+e[0].toUpperCase()+e.substring(1)}function c(e,t){try{return new MouseEvent(e,t)}catch(n){try{var a=document.createEvent("MouseEvent");return a.initMouseEvent(e,t.canBubble,t.cancelable,t.view,t.detail,t.screenX,t.screenY,t.clientX,t.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,t.button,t.relatedTarget),a}catch(i){var o=document.createEvent("Event");return o.initEvent(e,t.canBubble,t.cancelable),o}}}t.exports=function(e){function t(t){return t=f.configMerge(e.Annotation.defaults,t),f.isArray(t.annotations)&&t.annotations.forEach(function(t){t.label=f.configMerge(e.Annotation.labelDefaults,t.label),t.subLabel=f.configMerge(e.Annotation.subLabelDefaults,t.subLabel)}),t}function n(e,t,n,a){var i=t.filter(function(t){return!!t._model.ranges[e]}).map(function(t){return t._model.ranges[e]}),o=i.map(function(e){return Number(e.min)}).reduce(function(e,t){return isFinite(t)&&!isNaN(t)&&t<e?t:e},n),l=i.map(function(e){return Number(e.max)}).reduce(function(e,t){return isFinite(t)&&!isNaN(t)&&t>e?t:e},a);return{min:o,max:l}}function b(e){var t=n(e.id,i(e.chart),e.min,e.max);"undefined"==typeof e.options.ticks.min&&"undefined"==typeof e.options.ticks.suggestedMin&&(e.min=t.min),"undefined"==typeof e.options.ticks.max&&"undefined"==typeof e.options.ticks.suggestedMax&&(e.max=t.max),e.handleTickRangeOptions&&e.handleTickRangeOptions()}function d(e,t){var n=Number.POSITIVE_INFINITY;return e.filter(function(e){return e.inRange(t.x,t.y)}).reduce(function(e,a){var i=a.getCenterPoint(),o=f.distanceBetweenPoints(t,i);return o<n?(e=[a],n=o):o===n&&e.push(a),e},[]).sort(function(e,t){var n=e.getArea(),a=t.getArea();return n>a||n<a?n-a:e._index-t._index}).slice(0,1)[0]}var f=e.helpers;return{initConfig:t,elements:i,callEach:s,noop:a,objectId:o,isValid:l,decorate:r,adjustScaleRange:b,getNearestItems:d,getEventHandlerName:u,createMouseEvent:c}}},{}],6:[function(e,t,n){var a=e("chart.js");a="function"==typeof a?a:window.Chart,a.Annotation=a.Annotation||{},a.Annotation.drawTimeOptions={afterDraw:"afterDraw",afterDatasetsDraw:"afterDatasetsDraw",beforeDatasetsDraw:"beforeDatasetsDraw"},a.Annotation.defaults={drawTime:"afterDatasetsDraw",dblClickSpeed:350,events:[],annotations:[]},a.Annotation.labelDefaults={backgroundColor:"rgba(0,0,0,0.8)",fontFamily:a.defaults.global.defaultFontFamily,fontSize:a.defaults.global.defaultFontSize,fontStyle:"bold",fontColor:"#fff",xPadding:6,yPadding:6,cornerRadius:6,position:"center",xAdjust:0,yAdjust:0,enabled:!1,content:null},a.Annotation.subLabelDefaults={backgroundColor:"rgba(0,0,0,0.8)",fontFamily:a.defaults.global.defaultFontFamily,fontSize:a.defaults.global.defaultFontSize,fontStyle:"bold",fontColor:"red",xPadding:6,yPadding:6,cornerRadius:6,position:"center",xAdjust:0,yAdjust:0,enabled:!1,content:null},a.Annotation.Element=e("./element.js")(a),a.Annotation.types={line:e("./types/line.js")(a),box:e("./types/box.js")(a)};var i=e("./annotation.js")(a);t.exports=i,a.pluginService.register(i)},{"./annotation.js":2,"./element.js":3,"./types/box.js":7,"./types/line.js":8,"chart.js":1}],7:[function(e,t,n){t.exports=function(t){var n=e("../helpers.js")(t),a=t.Annotation.Element.extend({setDataLimits:function(){var e=this._model,t=this.options,a=this.chartInstance,i=a.scales[t.xScaleID],o=a.scales[t.yScaleID],l=a.chartArea;if(e.ranges={},l){var r=0,s=0;i&&(r=n.isValid(t.xMin)?t.xMin:i.getPixelForValue(l.left),s=n.isValid(t.xMax)?t.xMax:i.getPixelForValue(l.right),e.ranges[t.xScaleID]={min:Math.min(r,s),max:Math.max(r,s)}),o&&(r=n.isValid(t.yMin)?t.yMin:o.getPixelForValue(l.bottom),s=n.isValid(t.yMax)?t.yMax:o.getPixelForValue(l.top),e.ranges[t.yScaleID]={min:Math.min(r,s),max:Math.max(r,s)})}},configure:function(){var e=this._model,t=this.options,a=this.chartInstance,i=a.scales[t.xScaleID],o=a.scales[t.yScaleID],l=a.chartArea;e.clip={x1:l.left,x2:l.right,y1:l.top,y2:l.bottom};var r,s,u=l.left,c=l.top,b=l.right,d=l.bottom;i&&(r=n.isValid(t.xMin)?i.getPixelForValue(t.xMin):l.left,s=n.isValid(t.xMax)?i.getPixelForValue(t.xMax):l.right,u=Math.min(r,s),b=Math.max(r,s)),o&&(r=n.isValid(t.yMin)?o.getPixelForValue(t.yMin):l.bottom,s=n.isValid(t.yMax)?o.getPixelForValue(t.yMax):l.top,c=Math.min(r,s),d=Math.max(r,s)),e.left=u,e.top=c,e.right=b,e.bottom=d,e.borderColor=t.borderColor,e.borderWidth=t.borderWidth,e.backgroundColor=t.backgroundColor},inRange:function(e,t){var n=this._model;return n&&e>=n.left&&e<=n.right&&t>=n.top&&t<=n.bottom},getCenterPoint:function(){var e=this._model;return{x:(e.right+e.left)/2,y:(e.bottom+e.top)/2}},getWidth:function(){var e=this._model;return Math.abs(e.right-e.left)},getHeight:function(){var e=this._model;return Math.abs(e.bottom-e.top)},getArea:function(){return this.getWidth()*this.getHeight()},draw:function(){var e=this._view,t=this.chartInstance.chart.ctx;t.save(),t.beginPath(),t.rect(e.clip.x1,e.clip.y1,e.clip.x2-e.clip.x1,e.clip.y2-e.clip.y1),t.clip(),t.lineWidth=e.borderWidth,t.strokeStyle=e.borderColor,t.fillStyle=e.backgroundColor;var n=e.right-e.left,a=e.bottom-e.top;t.fillRect(e.left,e.top,n,a),t.strokeRect(e.left,e.top,n,a),t.restore()}});return a}},{"../helpers.js":5}],8:[function(e,t,n){t.exports=function(t){function n(e){var t=(e.x2-e.x1)/(e.y2-e.y1),n=e.x1||0;this.m=t,this.b=n,this.getX=function(a){return t*(a-e.y1)+n},this.getY=function(a){return(a-n)/t+e.y1},this.intersects=function(e,t,n){n=n||.001;var a=this.getY(e),i=this.getX(t);return(!isFinite(a)||Math.abs(t-a)<n)&&(!isFinite(i)||Math.abs(e-i)<n)}}function a(e,t,n,a){return a.x-n<0?a.x=n:a.x+t>e.clip.x2&&(a.x=e.clip.x2-t-n),a}function i(e,t,n,i,o,l,r){var s={x:0,y:0};return console.log("@@@ calculateMainLabelPosition()",JSON.stringify({view:e,width:t,height:n,padWidth:i,padHeight:o},null,2),l),s.x=(e.x1+e.x2-t)/2,s.y=(e.y1+e.y2-n)/2,s=a(e,t,i,s),r&&(s.y-=40),s}function o(e,t,n,i,o,l,r){if(!r)return{x:-9999,y:-9999};var s={x:0,y:0};return console.log("@@@ calculateSubLabelPosition()",JSON.stringify({view:e,width:t,height:n,padWidth:i,padHeight:o},null,2),l,s),s.x=(e.x1+e.x2-t)/2,s.y=(e.y1+e.y2-n)/2,s=a(e,t,i,s)}var l=t.helpers,r=e("../helpers.js")(t),s="horizontal",u=t.Annotation.Element.extend({setDataLimits:function(){var e=this._model,t=this.options;e.ranges={},e.ranges[t.scaleID]={min:t.value,max:t.endValue||t.value}},configure:function(){console.log("***","configure()");var e=this._model,t=this.options,a=this.chartInstance,u=a.chart.ctx,c=a.chart.annotation._index,b=this.chartInstance.chart.config.data.datasets[0].data[c];b&&(t.value=b.x);var d,f,h=a.scales[t.scaleID];if(h&&(d=r.isValid(t.value)?h.getPixelForValue(t.value):NaN,f=r.isValid(t.endValue)?h.getPixelForValue(t.endValue):d),!isNaN(d)){var g=a.chartArea;e.clip={x1:g.left,x2:g.right,y1:g.top,y2:g.bottom},this.options.mode===s?(e.x1=g.left,e.x2=g.right,e.y1=d,e.y2=f):(e.y1=g.top,e.y2=g.bottom,e.x1=d,e.x2=f),e.line=new n(e),e.mode=t.mode;var p=t.subLabel.callbacks.enabled(c),m=t.subLabel.callbacks.label(c),y=t.subLabel.callbacks.title(c);e.subLabelBackgroundColor=t.subLabel.backgroundColor,e.subLabelFontFamily=t.subLabel.fontFamily,e.subLabelFontSize=t.subLabel.fontSize,e.subLabelFontStyle=t.subLabel.fontStyle,e.subLabelFontColor=t.subLabel.color,e.subLabelSecondaryFontColor="rgb(0, 0, 0, 0.56)",e.subLabelXPadding=t.subLabel.xPadding,e.subLabelYPadding=t.subLabel.yPadding,e.subLabelCornerRadius=t.subLabel.cornerRadius,e.subLabelPosition=t.subLabel.position,e.subLabelXAdjust=t.subLabel.xAdjust,e.subLabelYAdjust=t.subLabel.yAdjust,e.subLabelEnabled=p,e.sublLabelLabel=m,e.sublLabelTitle=y,u.subLabelFont=l.fontString(e.subLabelFontSize,e.subLabelFontStyle,e.subLabelFontFamily);var x=u.measureText(e.sublLabelLabel).width+15,v=u.measureText(e.sublLabelTitle).width+15,L=Math.max(x,v);e.sublLabelLineHeight=u.measureText("M").width;var F=3.5*e.sublLabelLineHeight,D=o(e,L,F,e.subLabelXPadding,e.subLabelYPadding,this.chartInstance.chart.active?this.chartInstance.chart.active[0]:null,p);e.subLabelX=D.x-e.subLabelXPadding,e.subLabelY=D.y-e.subLabelYPadding,e.subLabelWidth=L+2*e.subLabelXPadding,e.subLabelHeight=F+2*e.subLabelYPadding,e.labelBackgroundColor=t.label.backgroundColor,e.labelFontFamily=t.label.fontFamily,e.labelFontSize=t.label.fontSize,e.labelFontStyle=t.label.fontStyle,e.labelFontColor=t.label.color,e.labelXPadding=t.label.xPadding,e.labelYPadding=t.label.yPadding,e.labelCornerRadius=t.label.cornerRadius,e.labelPosition=t.label.position,e.labelEnabled=t.label.callbacks.enabled(c),e.labelContent=t.label.callbacks.content(c),u.font=l.fontString(e.labelFontSize,e.labelFontStyle,e.labelFontFamily);var S=u.measureText(e.labelContent).width,P=u.measureText("M").width,M=i(e,S,P,e.labelXPadding,e.labelYPadding,null,p);e.labelX=M.x-e.labelXPadding,e.labelY=M.y-e.labelYPadding,e.labelWidth=S+2*e.labelXPadding,e.labelHeight=P+2*e.labelYPadding,e.borderColor=t.borderColor,e.borderWidth=t.borderWidth,e.borderDash=t.borderDash||[],e.borderDashOffset=t.borderDashOffset||0}},inRange:function(e,t){var n=this._model;return n.line&&n.line.intersects(e,t,this.getHeight())||n.labelEnabled&&n.labelContent&&e>=n.labelX&&e<=n.labelX+n.labelWidth&&t>=n.labelY&&t<=n.labelY+n.labelHeight},getCenterPoint:function(){return{x:(this._model.x2+this._model.x1)/2,y:(this._model.y2+this._model.y1)/2}},getWidth:function(){return Math.abs(this._model.right-this._model.left)},getHeight:function(){return this._model.borderWidth||1},getArea:function(){return Math.sqrt(Math.pow(this.getWidth(),2)+Math.pow(this.getHeight(),2))},draw:function(){console.log("***","draw()",this._view);var e=this._view,t=this.chartInstance.chart.ctx;e.clip&&(t.save(),t.beginPath(),t.rect(e.clip.x1,e.clip.y1,e.clip.x2-e.clip.x1,e.clip.y2-e.clip.y1),t.clip(),t.lineWidth=e.borderWidth,t.strokeStyle=e.borderColor,t.setLineDash&&t.setLineDash(e.borderDash),t.lineDashOffset=e.borderDashOffset,e.labelEnabled&&e.labelContent&&(t.beginPath(),t.moveTo(e.x1,e.y1),t.lineTo(e.x2,e.y2),t.stroke(),t.beginPath(),t.rect(e.clip.x1,e.clip.y1,e.clip.x2-e.clip.x1,e.clip.y2-e.clip.y1),t.clip(),t.fillStyle=e.labelBackgroundColor,l.drawRoundedRectangle(t,e.labelX,e.labelY,e.labelWidth,e.labelHeight,e.labelCornerRadius),t.fill(),t.font=l.fontString(e.labelFontSize,e.labelFontStyle,e.labelFontFamily),t.fillStyle=e.labelFontColor,t.textAlign="center",t.textBaseline="middle",t.fillText(e.labelContent,e.labelX+e.labelWidth/2,e.labelY+e.labelHeight/2)),e.subLabelEnabled,t.beginPath(),t.rect(e.clip.x1,e.clip.y1,e.clip.x2-e.clip.x1,e.clip.y2-e.clip.y1),t.clip(),t.fillStyle=e.subLabelBackgroundColor,l.drawRoundedRectangle(t,e.subLabelX,e.subLabelY,e.subLabelWidth,e.subLabelHeight,e.subLabelCornerRadius),t.fill(),t.font=l.fontString(e.subLabelFontSize,e.subLabelFontStyle,e.subLabelFontFamily),t.fillStyle=e.subLabelFontColor,t.textAlign="center",t.textBaseline="middle",t.fillText(e.sublLabelTitle,e.subLabelX+e.subLabelWidth/2,e.subLabelY+e.subLabelHeight/2-.7*e.sublLabelLineHeight),t.fillStyle=e.subLabelSecondaryFontColor,t.fillText(e.sublLabelLabel,e.subLabelX+e.subLabelWidth/2,e.subLabelY+e.subLabelHeight/2+1.2*e.sublLabelLineHeight),t.restore())}});return u}},{"../helpers.js":5}]},{},[6]);